<?php
$doc_kor = '청춘(靑春)! 이는 듣기만 하여도 가슴이 설레는 말이다. 청춘! 너의 두손을 가슴에 대고, 물방아 같은 심장의 고동(鼓動)을 들어 보라. 청춘의 피는 끓는다. 끓는 피에 뛰노는 심장은 거선(巨船)의 기관(汽罐)과 같이 힘있다. 이것이다. 인류의 역사를 꾸며 내려온 동력은 바로 이것이다. 이성은 투명하되 얼음과 같으며, 지혜는 날카로우나 갑 속에 든 칼이다. 청춘의 끓는 피가 아니더면, 인간이 얼마나 쓸쓸하랴? 얼음에 싸인 만물은 얼음이 있을 뿐이다. 그들에게 생명을 불어 넣는 것은 따뜻한 봄바람이다. 풀밭에 속잎나고, 가지에 싹이 트고, 꽃 피고 새 우는 봄날의 천지는 얼마나 기쁘며, 얼마나 아름다우냐? 이것을 얼음 속에서 불러 내는 것이 따뜻한 봄바람이다. 인생에 따뜻한 봄바람을 불어 보내는 것은 청춘의 끓는 피다. 청춘의 피가 뜨거운지라, 인간의 동산에는 사랑의 풀이 돋고, 이상의 꽃이 피고, 희망의 놀이 뜨고, 열락(悅樂)의 새가 운다. 사랑의 풀이 없으면 인간은 사막이다. 오아이스도 없는 사막이다. 보이는 끝까지 찾아다녀도, 목숨이 있는 때까지 방황하여도, 보이는 것은 거친 모래뿐일 것이다. 이상의 꽃이 없으면, 쓸쓸한 인간에 남는 것은 영락(零落)과 부패(腐敗)뿐이다. 낙원을 장식하는 천자만홍(千紫萬紅)이 어디 있으며, 인생을 풍부하게 하는 온갖 과실이 어디 있으랴? 이상! 우리의 청춘이 가장 많이 품고 있는 이상! 이것이야말로 무한한 가치를 가진 것이다. 사람은 크고 작고 간에 이상이 있음으로써 용감하고 굳세게 살 수 있는 것이다. 석가는 무엇을 위하여 설산(雪山)에서 고행을 하였으며, 예수는 무엇을 위하여 광야에서 방황하였으며, 공자는 무엇을 위하여 천하를 철환(轍環)하였는가 ? 밥을 위하여서. 옷을 위하여서, 미인을 구하기 위하여서 그리하였는가? 아니다. 그들은 커다란 이상, 곧 만천하의 대중을 품에 안고, 그들에게 밝은 길을 찾아 주며, 그들을 행복스럽고 평화스러운 곳으로 인도하겠다는 커다란 이상을 품었기 때문이다. 그러므로 그들은 길지 아니한 목숨을 사는가 싶이 살았으며, 그들의 그림자는 천고에 사라지지 않는 것이다. 이것은 현저하게 일월과 같은 예가 되려니와, 그와 같지 못하다 할지라도 창공에 반짝이는 뭇 별과 같이, 산야에 피어나는 군영(群英)과 같이, 이상은 실로 인간의 부패를 방지하는 소금이라 할지니, 인생에 가치를 주는 원질(原質)이 되는 것이다. 그들은 앞이 긴지라 착목(着目)한는 곳이 원대하고, 그들은 피가 더운지라 실현에 대한 자신과 용기가 있다. 그러므로 그들은 이상의 보배를 능히 품으며, 그들의 이상은 아름답고 소담스러운 열매를 맺어, 우리 인생을 풍부하게 하는 것이다. 보라, 청춘을 ! 그들의 몸이 얼마나 튼튼하며, 그들의 피부가 얼마나 생생하며, 그들의 눈에 무엇이 타오르고 있는가? 우리 눈이 그것을 보는 때에, 우리의 귀는 생의 찬미(讚美)를 듣는다. 그것은 웅대한 관현악(管絃樂)이며, 미묘(微妙)한 교향악(交響樂)이다. 뼈 끝에 스며들어 가는 열락의 소리다.이것은 피어나기 전인 유소년에게서 구하지 못할 바이며, 시들어 가는 노년에게서 구하지 못할 바이며, 오직 우리 청춘에서만 구할 수 있는 것이다. 청춘은 인생의 황금시대다. 우리는 이 황금시대의 가치를 충분히 발휘하기 위하여, 이 황금시대를 영원히 붙잡아 두기 위하여, 힘차게 노래하며 힘차게 약동하다. (全文)';

$doc_eng = 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla dictum ac orci id egestas. Donec faucibus sit amet dui non pharetra. Phasellus quis nulla faucibus, facilisis lacus tincidunt, molestie erat. Maecenas libero orci, blandit non ligula sed, vulputate porta est. Sed et tellus et ligula semper euismod et at orci. Suspendisse a velit nec ipsum dignissim auctor. Interdum et malesuada fames ac ante ipsum primis in faucibus. Sed sed tincidunt ex. Maecenas vel auctor nulla, at lobortis nibh. Praesent efficitur commodo massa ac sagittis. Duis varius diam turpis, non pellentesque felis posuere sed. Nam placerat nec nisl nec aliquet. Donec a tempor velit, at pretium nibh. Cras ante mi, interdum pulvinar scelerisque eget, viverra ac dolor. Nunc interdum consectetur feugiat. Morbi nec sapien ornare, vehicula velit convallis, molestie dui. Vestibulum rutrum et sapien cursus aliquam. Ut tortor purus, fringilla id convallis ac, ullamcorper ut justo. Donec maximus urna vitae ante volutpat, eget ultrices tellus aliquet. Integer commodo, tortor id mattis euismod, orci nibh tristique tortor, in pellentesque ipsum quam ac libero. Duis pellentesque nunc ac sapien sodales, non tincidunt dui finibus. Praesent imperdiet tempus massa, et sagittis massa dapibus eget. Cras sagittis, ligula at tincidunt tincidunt, enim nibh volutpat augue, eu porttitor dolor mi ut ligula. Phasellus sapien diam, consectetur id pretium at, pulvinar non urna. Aenean commodo nunc diam, sit amet viverra elit varius eget. Cras luctus leo molestie, feugiat leo convallis, blandit nisl. Fusce vehicula aliquam justo id egestas. Nulla vitae lacus euismod turpis varius pretium eget vitae arcu. Etiam leo enim, placerat eget mattis at, consequat eget mauris. Mauris pharetra vehicula porta. Sed non consequat enim, sed finibus nisl. Quisque vel venenatis elit. Cras consectetur euismod nibh. Suspendisse dapibus aliquam leo, id convallis metus cursus lacinia. Donec nec augue at sapien vehicula lacinia. Pellentesque id est vulputate, dignissim sapien a, rutrum sem. Sed ultricies lacus magna, at imperdiet lectus finibus eu. Fusce facilisis, augue eu hendrerit ultrices, lectus quam imperdiet tellus, eu commodo lectus sem eu ex. Ut auctor at enim ac egestas. Phasellus et libero tortor. Cras felis mauris, ultricies vel lacus ut, venenatis varius est. Ut rutrum luctus sem id cursus. Duis bibendum, sem sed rutrum interdum, est sem blandit mauris, eget aliquet ipsum risus sit amet elit. Pellentesque vehicula, purus vel interdum facilisis, turpis justo facilisis diam, eu vulputate ex ex non arcu. Sed dignissim quis orci ut eleifend. Mauris et purus et lorem fringilla tristique et non magna. Donec semper leo lectus, sit amet semper massa hendrerit in. Proin luctus nulla sem, sit amet lobortis enim cursus sed. Suspendisse tristique tempus nibh, et feugiat dui viverra ac. Ut non ullamcorper ante. Etiam imperdiet vitae magna id accumsan. Etiam vitae justo in augue sollicitudin aliquam vitae non ligula. Donec ante felis, maximus vel auctor non, lacinia ut purus. Nunc pretium elementum ipsum eget lobortis. Fusce vitae volutpat tellus. Nam ornare ante vel leo blandit, sed consequat enim dapibus. Etiam dictum lacus non faucibus sodales. Aenean ac dui ut augue ornare elementum ut et metus. Mauris efficitur egestas massa, ut luctus enim hendrerit sit amet. Suspendisse nec urna tortor. Suspendisse vel purus quis nunc egestas vulputate. Suspendisse posuere est leo, vel ullamcorper ipsum consectetur sed. Duis a justo at leo porta sagittis. Phasellus vel venenatis diam, at lobortis mauris. Vestibulum vitae metus maximus, congue arcu ac, maximus lectus. Nam cursus, turpis sed semper sollicitudin, lacus lacus tincidunt elit, sit amet semper magna metus ut lectus. Donec eros elit, convallis sed faucibus ut, commodo vitae nibh. Integer sapien metus, convallis quis dapibus eget, fermentum id risus.';

class Mock {
	var $lang = 'kor';
	var $type = 'list';
	var $doc = null;
	var $doc_max = null;
	var $page = 1;
	var $size = 10;
	var $total = 1000;
	var $type_arr = array('list', 'get', 'edit', 'del');
	var $defined_type = array('id', 'ip', 'date', 'string');
	var $fields = array();

	public function __construct($fields, $lang=null) {
		global $doc_kor, $doc_eng;
		$this->fields = $fields;
		$this->lang = null === $lang ? $this->lang : strtolower($lang);
		if ('all' === $this->lang) {
			$this->doc = $doc_kor . ' ' . $doc_eng;
		} else {
			$this->doc = ${'doc_' . $this->lang};
		}
		$this->doc_max = strlen($this->doc);
	}

	private function enc($str) {
		$s = strpos($str, ' ')+1;
		$e = strrpos($str, ' ');
		return str_replace('?', '', mb_convert_encoding(substr($str, $s, $e-$s), 'UTF-8', 'UTF-8'));
	}

	private function make($index=null) {
		$data = array();
		foreach ($this->fields as $field => $field_type) {
			$max = $this->doc_max;
			if ('array' === gettype($field_type) 
				&& isset($field_type['max']) 
				&& 'integer' === gettype($field_type['max'])
			) {
				$max = $field_type['max'];
				$field_type = 'string';
			}
			switch($field_type) {
				case 'id':
					$mock = null === $index ? rand(0, $this->doc_max) : $index;
					break;
				case 'string':
					$s = rand(0, $this->doc_max);
					$length = rand(0, $max);
					$mock = $this->enc(substr($this->doc, $s, $length));
					break;
				case 'ip':
					$mock = implode('.', array(rand(0, 255), rand(0, 255), rand(0, 255), rand(0, 255)));
					break;
				case 'date':
					$mock = date('Y-m-d H:i:s', rand(strtotime('1/1/2014'), strtotime('now')));
					break;
				default:
					$s = rand(0, $this->doc_max);
					$mock = $this->enc(substr($this->doc, $s, rand($s, $this->doc_max)));
					break;
			}
			if (strlen($mock) < 1) {
				return $this->make($index);
			}
			$data[$field] = $mock;
		}
		return $data;
	}

	public function gen($type=null, $page=null, $size=null, $total=null) {
		$type = null === $type ? $this->type : $type;
		$page = null === $page ? $this->page : $page;
		$size = null === $size ? $this->size : $size;
		$this->total = null === $total ? $this->total : $total;
		$response = null;
		if (in_array($type, $this->type_arr)) {
			if (in_array($type, array('edit', 'del'))) {
				$response = json_encode(array('result'=> true));
			} else if ('get' === $type) {
				$response = json_encode(array(
					'result'=> true, 
					'data'=> $this->make()
				));
			} else if ('list' === $type) {
				$list = array();
				$max=$page*$size;
				$max = $this->total < $max ? $this->total : $max;
				for ($i=($page-1)*$size; $i<$max; $i++) {
					array_push($list, $this->make($i+1));
				}
				$response = json_encode(array(
					'result'=> true, 
					'total'=> $total,
					'list'=> $list
				));
			}
		}
		return $response;
	}
}

header('Content-Type: application/json; charset=utf-8');
header('Cache-Control: no-cache, must-revalidate');

$type = !empty($_GET['type']) ? $_GET['type'] : null;
$lang = !empty($_GET['lang']) ? $_GET['lang'] : null;
$page = !empty($_GET['page']) ? (int) $_GET['page'] : null;
$size = !empty($_GET['size']) ? (int) $_GET['size'] : null;
$total = !empty($_GET['total']) ? (int) $_GET['total'] : null;

$Mock = new Mock(array(
	'id'		=> 'id',
	'name'		=> array('max'=> 45),
	'title'		=> array('max'=> 255),
	'content'	=> 'string',
	'ip'		=> 'ip',
	'reg_ate'	=> 'date'
), $lang);

$response = $Mock->gen($type, $page, $size, $total);

if (!empty($_GET['callback'])) {
	echo preg_replace('/[^a-zA-Z0-9_]+/', '', $_GET['callback']) . '(' . $response . ')';
} else {
	echo $response;
}
?>